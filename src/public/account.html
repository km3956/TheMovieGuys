<!doctype html>
<html>
  <head>
    <title>Your Account</title>
    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
    <link rel="icon" type="image/x-icon" href="../images/favicon.ico" />
    <link rel="stylesheet" href="./css/style.css" />
  </head>
  <body class="bg-dark">
    <div id="nav-content"></div>
    <div id="user-content" class="row gutters-sm justify-content-center">
      <div id="user-welcome" class="col-md-3 mb-3">
        <div id="welcome-card" class="card text-bg-secondary border-light p-3">
          <div
            id="welcome-content"
            class="d-flex flex-column align-items-center text-center"
          >
            <div class="mt-3">
              <h3 id="welcome-name"></h3>
              <p id="movie-count"></p>
              <p id="show-count"></p>
              <button
                id="followerButton"
                type="button"
                class="btn btn-primary"
                data-bs-toggle="modal"
                data-bs-target="#followerModal"
              ></button>
              <button
                id="followingButton"
                type="button"
                class="btn btn-primary"
                data-bs-toggle="modal"
                data-bs-target="#followingModal"
              ></button>
              <button
                id="addFriendsButton"
                type="button"
                class="btn btn-success"
                data-bs-toggle="modal"
                data-bs-target="#addFriendsModal"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  fill="currentColor"
                  class="bi bi-person-fill-add"
                  viewBox="0 0 16 16"
                >
                  <path
                    d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m.5-5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 1 0m-2-6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"
                  />
                  <path
                    d="M2 13c0 1 1 1 1 1h5.256A4.5 4.5 0 0 1 8 12.5a4.5 4.5 0 0 1 1.544-3.393Q8.844 9.002 8 9c-5 0-6 3-6 4"
                  />
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>

      <div id="user-info" class="col-sm-6">
        <div id="info-card" class="card text-bg-secondary border-light p-3">
          <div class="card-body">
            <h4
              id="info-content"
              class="card-title"
              style="margin-bottom: 10px"
            >
              Your account information:
            </h4>
            <hr />
            <div class="row">
              <div class="col-sm-3">
                <h5>Username</h5>
              </div>
              <div id="user-name" class="col-sm-9"></div>
            </div>
            <hr />
            <div class="row">
              <div class="col-sm-3">
                <h5>Display Name</h5>
              </div>
              <div id="display-name" class="col-sm-9"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="movie-container" class="container">
      <div class="row-title">
        <h3>Your Liked Movies:</h3>
      </div>
      <div
        id="liked-movie-carousel"
        class="carousel carousel-light slide"
        data-bs-interval="false"
      >
        <div id="liked-movies" class="carousel-inner"></div>
        <button
          class="carousel-control-prev"
          type="button"
          data-bs-target="#liked-movie-carousel"
          data-bs-slide="prev"
        >
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button
          class="carousel-control-next"
          type="button"
          data-bs-target="#liked-movie-carousel"
          data-bs-slide="next"
        >
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
    </div>

    <div id="tv-container" class="container">
      <div class="row-title">
        <h3>Your Liked TV Shows:</h3>
      </div>
      <div
        id="liked-tv-carousel"
        class="carousel carousel-light slide"
        data-bs-interval="false"
      >
        <div id="liked-shows" class="carousel-inner"></div>
        <button
          class="carousel-control-prev"
          type="button"
          data-bs-target="#liked-tv-carousel"
          data-bs-slide="prev"
        >
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button
          class="carousel-control-next"
          type="button"
          data-bs-target="#liked-tv-carousel"
          data-bs-slide="next"
        >
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
    </div>

    <div class="container">
      <div class="row-title">
        <h3 id="friends-liked-title"></h3>
      </div>
      <div
        id="friends-liked-carousel"
        class="carousel carousel-light slide"
        data-bs-interval="false"
      >
        <div id="friends-liked" class="carousel-inner"></div>
      </div>
    </div>

    <div
      class="modal fade"
      id="followerModal"
      tabindex="-1"
      aria-labelledby="followerLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="followerLabel">Followers:</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <ul id="follower-list" class="list-group list-group-flush"></ul>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal fade"
      id="followingModal"
      tabindex="-1"
      aria-labelledby="followingLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="followingLabel">Following:</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <ul id="following-list" class="list-group list-group-flush"></ul>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal fade"
      id="addFriendsModal"
      tabindex="-1"
      aria-labelledby="followingLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="followingLabel">Add Friends</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form class="row justify-content-center">
              <div class="col-auto">
                <input
                  id="searchFriendsInput"
                  class="form-control mr-sm-2"
                  type="search"
                  placeholder="Search"
                  aria-label="Search"
                />
              </div>
              <div class="col-auto">
                <button
                  id="searchFriendsBtn"
                  class="btn btn-outline-success my-2 my-sm-0"
                  type="button"
                >
                  Search
                </button>
              </div>
            </form>
            <div id="searchResults" class="list-group list-group-flush"></div>
            <div id="status"></div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="account.js"></script>
  </body>
</html>

<script>
  $(document).ready(function () {
    $("#nav-content").load("./components/nav.html", () => {
      setLogoutButton();
    });
  });

  async function setLogoutButton() {
    let response = await fetch("/check-login", {
      method: "GET",
      credentials: "include",
    });

    if (response.ok) {
      let button = document.getElementById("login-button");
      button.textContent = "Logout";
      button.href = "./index.html";
      button.addEventListener("click", async () => {
        let result = await fetch("/logout");
      });
    }
  }
</script>
